{% extends "base.html" %}
{% block content %}
<div class="container">
<form method="POST">
    {% if edit %}
    <h3>Edit department</h3>
    {% else %}
    <h3>Create a new department</h3>
    {% endif %}
    <div class="form-group">
        <label for="name">Name</label>
        <input type="text" class="form-control" id="name" placeholder="Enter name" name="name" value="{{name}}">
    </div>
    <div class="form-group">
        <label for="address">Address</label>
        <input type="text" class="form-control" id="address" placeholder="Enter address" name="address" value="{{address}}">
    </div>
    <div class="form-group">
        <label for="img_url">Image URL</label>
        <input type="text" class="form-control" id="img_url" placeholder="Enter a URL" name="img_url" value="{{img_url}}">
    </div>
    <div class="form-group">
        <label for="description">Description</label>
        <textarea class="form-control" id="description" rows="6" name="description">{{description}}</textarea>
    </div>
    <small class="form-text text-muted">None of the fields can be empty.</small>

    <div class="form-group" id="error-msg">{{error}}</div>

    <button class="btn btn-default" id="cancel-button">Cancel</button>
    <button type="submit" class="btn btn-primary" id="submit-button">Submit</button>
</form>
</div>

<!-- jQuery -->
<script src="{{ url_for('static', filename='js/jquery.js') }}"></script>

<script type="text/javascript">
    // disable submit button if input is empty using jquery
    // go to prev page on clicking cancel
    $(function(){
        $('#submit-button').attr('disabled', 'disabled');
        // use this to detect pre-filled values in edit
        $('.form-group > input').each(function() {
            if ($(this).val() != '' || ($('#description')[0].value != "")) {
                $('#submit-button').removeAttr('disabled');
            }
        });

        // disable submit button if any input is empty
        $('.form-group > input, textarea').keyup(function() {

            var empty = false;
            $('.form-group > input').each(function() {
                if ($(this).val() == '' || ($('#description')[0].value == "")) {
                    empty = true;
                }
            });
            if (empty) {
                $('#submit-button').attr('disabled', 'disabled'); 
            } else {
                $('#submit-button').removeAttr('disabled'); 
            }
        });
        $('#cancel-button').on('click',function(){
            window.location.href = window.history.back();
        })
    });

</script>

{% endblock %}